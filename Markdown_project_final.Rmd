---
title: NSW Groundwater hydrogeochemistry
subtitle: Field analyses
author: Chloe Plet
affiliation: "CSIRO Mineral Resources - Team: Minerals and Water" # Or group/team
photo: resources/img/photo.jpeg

#short_title: Optional short title

output: DSreport::project_summary
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  results = 'asis',
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.align = 'center'
)

#Load libraries
library(tidyverse)
library(kableExtra)
library(sf)
library(ggplot2)
library(colorspace)
library(gganimate)



#read files and create dataframes
Field_NSW<-read_csv("resources/results/Obs_Field_simple.csv")
Field_NSW_figs<- read_csv("resources/results/Obs_Field_simple_figs.csv")
```


# Introduction

With a background on biominerals, palaeoenvironemental reconstruction and organic geochemistry, I am now a postdoctoral researcher at CSIRO. Although I learned some matlab during my undergrad, I had never really understood it or used it. I was mostly using excel, which often made me very frustrated. I really enjoyed the data school FOCUS particularly learning to "speak to computers" and basic coding skills. Learning R basics has definitely changed my perspective on how to record data and given me a new view on time management when receiving large and complex excel datasheets. 


# My Project

I worked on hydrogeochemical data from a NSW groundwater survey. My initial goal was to build a script that I could use for our groundwater surveys in NSW but also Australia-wide. These reason for these groundwater analyses is the identification and of buried mineral deposits.The secondary objective was to supply groundwater information to the population. 
To do so I aimed to combine field observations and geolocation with a range of laboratory analyses. Unfortunately, this was too optimistic within Data School FOCUS timeframe and my personal availabilities. I have since simplified the dataset focusing on field collected data for this presentation and an extract of the final table is presented below.



## Preliminary results

This section will demonstrate the different visuals you might want use to show off your 
project. Don't feel the need to go overboard, this is supposed to give a taste of the work you are
doing rather than being a publication ready document.

To get tables formatting correctly, use `knitr::kable` to convert the table to html format. If
you also want to have alternate row highlighting, pass the result to `kable_styling('striped')` 
from the `kableExtra` package.

**Tables**
```{r mytable, out.width='100%', echo = T}
knitr::kable(head(Field_NSW, n = 5), format = "html", caption = "Field data") %>% 
  kable_styling("striped")
```

**Images from a file**

![](resources/img/tidyverse.png){width=100px}

**Plots from R**
```{r standard-plot, out.width='60%', fig.align='center', fig.height= 4, fig.width=6, fig.cap="Yet another gapminder plot"}
  
# Read the state shapes in and simplify them for faster plotting
# (The coastlines are *really* accurate and would take too long if we tried to plot them as is)
state_borders <- read_sf("resources/AUS_states") %>%
  st_simplify(dTolerance = 0.01)


    

Temperature_plot<- ggplot(data = subset(Field_NSW_figs, !is.na(Temperature)),
       mapping=aes(x = Longitude, 
                   y = Latitude,
                   colour = Temperature
                  ))+
  geom_sf(data = state_borders, inherit.aes = F)+
         geom_point()+
     scale_color_gradient2(low = "royalblue1", mid = "gold1", high = "firebrick1",midpoint = 18, space = "Lab", guide = "colourbar", aesthetics = "colour")+
  scale_x_continuous(limits =  c(140,154)) + 
  scale_y_continuous(limits = c(-38,-28))+
  theme(panel.background = element_rect(fill = "lightblue"), panel.grid= element_blank())



anim_Temperature<-Temperature_plot+
    transition_states(Temperature)+
     shadow_mark(past = TRUE, future = FALSE, alpha = alpha/2)

animate(anim_Temperature)


Conductivity_plot<- ggplot(data = subset(Field_NSW_figs, !is.na(Conductivity_group)),
                 mapping= aes(x= Longitude, 
                             y= Latitude, 
                             colour = Conductivity_group))+
geom_sf(data = state_borders, inherit.aes= F)+
 geom_point()+
 scale_color_brewer(palette ="YlGnBu")+ 
 scale_x_continuous(limits =  c(140,154)) + 
 scale_y_continuous(limits = c(-38,-28))+
  theme(panel.background = element_rect(fill = "lightblue"), panel.grid= element_blank())


pH_plot<- ggplot(data = subset(Field_NSW_figs, !is.na(pH_group)), 
                 mapping= aes(x= Longitude, 
                              y= Latitude, 
                              colour = pH_group))+
  geom_sf(data = state_borders, inherit.aes= F)+
  geom_point()+
  scale_color_brewer(palette = "YlOrRd")+
  scale_x_continuous(limits =  c(140,154)) + 
  scale_y_continuous(limits = c(-38,-28))+
  theme(panel.background = element_rect(fill = "lightblue"), panel.grid= element_blank())


anim_pH<-pH_plot+
    transition_states(pH)+
     shadow_mark(past = TRUE, future = FALSE, alpha = alpha/2)

animate(anim_pH)

Eh_plot<- ggplot(data = subset(Field_NSW_figs,!is.na(Eh_group)),
                 mapping= aes(x= Longitude, 
                              y= Latitude, 
                              colour = Eh_group))+
  geom_sf(data = state_borders, inherit.aes= F)+
  geom_point()+
  scale_color_brewer(palette = "RdYlGn")+
  scale_x_continuous(limits =  c(140,154)) + 
  scale_y_continuous(limits = c(-38,-28))+
  theme(panel.background = element_rect(fill = "lightblue"), panel.grid= element_blank())

anim_Eh<-Eh_plot+
   transition_states(Eh)+
     shadow_mark(past = TRUE, future = FALSE, alpha = alpha/2)

animate(anim_Eh)

```

Your figure and table captions are automatically numbered and can be referenced in the text
if needed: see eg. Table \@ref(tab:mytable) and Figure \@ref(fig:standard-plot)

# My Digital Toolbox

Since starting Data School FOCUS I have used a the following R packages
* tidyverse
* Dplyr
* ggplot
* gganimate
* sp (for the Australian map)


# My time went ...

My time went into data wrangling... and I have had to let it go in order to be able to get a markdown document ready for the final presentation. Because the dataset I was working with was partly put together by people, partly by machines, and different labs have different format output for their report, this has been particularly challenging. 

# Next steps

* I would like to achieve my original objective of writing a script that could handle the data wrangling automatically, supplying us with a tidy dataset. I am also hoping to gain a better understanding of the visualisation potential of R, and make the final visualisation interactive for the reader. 

*The next step for me is also to learn Python, because nobody I work with knows R which strongly limits the collaborations and the support I can receive during my learning.


# My Data School Experience

I really enjoyed the continuous format of this program. While most trainings are condensed over a couple of days, Data School FOCUS allowed for time to actually assimilate the new concepts and practise new skills with strong and personalised support from the teaching team. It  felt like being back at school and having a dedicated time for it every week was great. I have not had the opportunity yet to apply newly acquired skills to my own work. 
On a more personal and practical aspect, being in WA with the program running in spring, the start at 7 am was definitely a challenge. From a work perspective, continuing my work day at the end of a data school day was difficult as I was struggling focus, and overall my own work got quite delayed.

